<?xml version="1.0" encoding="utf-8"?>
<Window
    x:Class="WinSsh.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:WinSsh"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:media="using:Microsoft.UI.Xaml.Media"
    xmlns:controls="using:Microsoft.UI.Xaml.Controls"
    xmlns:mui="using:Microsoft.UI.Xaml.Input"
    mc:Ignorable="d"
    Title="WinSsh">

    <!-- Correct: Only one backdrop object here -->
    <Window.SystemBackdrop>
        <media:MicaBackdrop Kind="Base"/>
    </Window.SystemBackdrop>


    <!-- Single root element for all your content -->
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <!--  TitleBar  -->
            <RowDefinition Height="*" />
            <!--  NavigationView  -->
        </Grid.RowDefinitions>

        <TitleBar
            x:Name="titleBar"
            Title="WinSsh"
            Subtitle="Preview"
            IsBackButtonVisible="False"
            PaneToggleRequested="titleBar_PaneToggleRequested"
            IsPaneToggleButtonVisible="True">
            <TitleBar.IconSource>
                <ImageIconSource ImageSource="/Assets/Tiles/GalleryIcon.ico" />
            </TitleBar.IconSource>
            <TitleBar.Content>
                <AutoSuggestBox
                    Width="360"
                    VerticalAlignment="Center"
                    PlaceholderText="Search.."
                    QueryIcon="Find" />
            </TitleBar.Content>
        </TitleBar>

        <NavigationView
            x:Name="navView"
            Grid.Row="1"
            SelectionChanged="navView_SelectionChanged"
            IsBackButtonVisible="Collapsed"
            IsPaneToggleButtonVisible="False"
            IsSettingsVisible="True"
            ItemInvoked="navView_ItemInvoked">
            <NavigationView.MenuItems>
                <NavigationViewItem 
                    Icon="Home" 
                    Content="Home" 
                    Tag="HomePage" />
                <NavigationViewItem 
                    x:Name="connectionsViewItem"
                    Content="Connections" 
                    Tag="Connections">
                    <NavigationViewItem.Icon>
                        <FontIcon Glyph="&#xE756;"/>
                    </NavigationViewItem.Icon>
                </NavigationViewItem>
            </NavigationView.MenuItems>

            <Grid>
                <!-- Frame for navigation pages -->
                <Frame x:Name="navFrame" />

                <!-- Terminal content (original content for legacy profile management) -->
                <Grid x:Name="terminalContent" Visibility="Collapsed" Margin="0,32">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="340"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>

                    <!-- Left pane: Profiles -->
                    <Grid Grid.Column="0" Margin="10">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>


                        <ListView 
                            x:Name="ProfilesList" 
                            Grid.Row="1"
                            DisplayMemberPath="Name"
                            DoubleTapped="ProfilesList_DoubleTapped"
                            SelectionChanged="ProfilesList_SelectionChanged" />

                    </Grid>

                    <!-- Right pane: Info -->
                    <Grid Grid.Column="1" Margin="10">
                        <TextBlock 
                            Text="Select a profile and click 'Open Connection' to connect"
                            VerticalAlignment="Center"
                            HorizontalAlignment="Center"
                            Opacity="0.6"/>
                    </Grid>
                </Grid>
            </Grid>
        </NavigationView>



    </Grid>
</Window>